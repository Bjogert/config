# ================================
# 🧪 MQTT TEST AUTOMATION
# ================================
# Simple automation to test MQTT connectivity

- id: mqtt_test_listener
  alias: "🧪 MQTT Test Listener" 
  description: 'Responds to MQTT test messages'
  triggers:
  - trigger: mqtt
    topic: chickens/test
  actions:
  - action: notify.persistent_notification
    data:
      title: "🧪 MQTT Test Success"
      message: >
        ✅ MQTT is working! 
        Received test message: {{ trigger.payload }}
        Time: {{ now().strftime('%H:%M:%S') }}
  - action: system_log.write
    data:
      message: "MQTT test successful - received: {{ trigger.payload }}"
      level: info
  mode: single

# Test automation for chicken system
- id: chicken_system_test
  alias: "🐔 Chicken System Test"
  description: 'Test automation for chicken MQTT messages'
  triggers:
  - trigger: mqtt
    topic: chickens/+
  actions:
  - action: system_log.write  
    data:
      message: "Chicken MQTT received - Topic: {{ trigger.topic }}, Payload: {{ trigger.payload }}"
      level: info
  - action: notify.persistent_notification
    data:
      title: "🐔 Chicken MQTT Received"
      message: >
        Topic: {{ trigger.topic }}
        Data: {{ trigger.payload }}
        Time: {{ now().strftime('%H:%M:%S') }}
  mode: single
